{
  "timestamp": "2026-02-20T19:58:23.976435",
  "demand_threshold": 1.0,
  "n_features": 51,
  "feature_names": [
    "precio_unitario_usd",
    "margen_pct",
    "tiene_promocion",
    "tipo_promocion",
    "pct_descuento",
    "es_perecedero",
    "dia_semana",
    "es_fin_semana",
    "mes",
    "a\u00f1o",
    "dia_mes",
    "semana_a\u00f1o",
    "trimestre",
    "es_quincena",
    "dias_para_fin_mes",
    "es_inicio_mes",
    "es_fin_mes",
    "dia_semana_sin",
    "dia_semana_cos",
    "mes_sin",
    "mes_cos",
    "unidades_lag_1",
    "unidades_lag_7",
    "unidades_lag_14",
    "unidades_lag_28",
    "unidades_mean_7d",
    "unidades_std_7d",
    "unidades_mean_14d",
    "unidades_std_14d",
    "unidades_min_14d",
    "unidades_max_14d",
    "unidades_mean_30d",
    "unidades_std_30d",
    "unidades_min_30d",
    "unidades_max_30d",
    "unidades_trend_14d",
    "precio_var_1d",
    "precio_var_7d",
    "precio_mean_7d",
    "precio_mean_30d",
    "precio_historico_producto",
    "precio_vs_historico",
    "precio_mean_clase",
    "precio_vs_clase",
    "dias_en_promocion",
    "dias_desde_promo",
    "precio_medio_usd",
    "variabilidad_demanda",
    "precio_x_finsemana",
    "promo_x_finsemana",
    "precio_x_perecedero"
  ],
  "train_size": 708701,
  "val_size": 264904,
  "test_size": 278350,
  "optuna_trials_lgbm": 30,
  "optuna_trials_xgb": 30,
  "two_stage_results": {
    "lgbm_two_stage": {
      "metrics": {
        "MAE": 3.1533464032755463,
        "MSE": 87.63143709486782,
        "RMSE": 9.361166438797454,
        "R2": 0.9379508394743896,
        "RMSLE": 0.3125289968668503,
        "MAPE": 47.2359270059751,
        "SMAPE": 44.99340994070831,
        "WMAPE": 23.612425949232552,
        "MdAE": 0.891140590479541,
        "MPE": 17.66092050085456,
        "MBE": -0.7281255351002401,
        "OverForecastRate": 54.84749416202622,
        "WMAPE_revenue": 26.65614243083555,
        "clf_threshold": 0.5113065326633166,
        "demand_threshold": 1.0,
        "clf_precision": 0.9450170714423758,
        "clf_recall": 0.9582048327120202,
        "clf_f1": 0.951565261911767,
        "clf_prob_mean_high": 0.9373581584133004,
        "clf_prob_mean_low": 0.24299693344290366,
        "low_demand_tp": 50397.0,
        "low_demand_fp": 7551.0,
        "low_demand_fn": 13622.0,
        "low_demand_tn": 206780.0,
        "low_demand_precision": 0.8696935183267758,
        "low_demand_recall": 0.7872194192349147,
        "low_demand_f1": 0.8264038633400839,
        "zero_f1": 0.8264038633400839,
        "MASE": 0.5689699817531078,
        "alpha_0.1_coverage": 90.29315609843722,
        "alpha_0.1_width": 10.90613356123115,
        "alpha_0.2_coverage": 80.21160409556313,
        "alpha_0.2_width": 5.8628573319100905
      },
      "params": {
        "learning_rate": 0.03908294667479063,
        "num_leaves": 106,
        "min_child_samples": 51,
        "subsample": 0.6023052293389355,
        "colsample_bytree": 0.6547235997514183,
        "reg_alpha": 7.708035943595551,
        "reg_lambda": 3.6178661323367485e-07
      },
      "train_time_sec": 4052.1387729644775
    },
    "xgb_two_stage": {
      "metrics": {
        "MAE": 3.157508476983347,
        "MSE": 88.64279159649372,
        "RMSE": 9.415030090047175,
        "R2": 0.9372347300517888,
        "RMSLE": 0.31272422460236876,
        "MAPE": 47.44067235637819,
        "SMAPE": 44.963313498851385,
        "WMAPE": 23.643591779005835,
        "MdAE": 0.8929173946380615,
        "MPE": 18.169559164108055,
        "MBE": -0.6455709256882494,
        "OverForecastRate": 55.21573558469552,
        "WMAPE_revenue": 26.87050567379865,
        "clf_threshold": 0.5113065326633166,
        "demand_threshold": 1.0,
        "clf_precision": 0.944954128440367,
        "clf_recall": 0.9587273889451363,
        "clf_f1": 0.9517909334716734,
        "clf_prob_mean_high": 0.9372144341468811,
        "clf_prob_mean_low": 0.24167892336845398,
        "low_demand_tp": 50310.0,
        "low_demand_fp": 7404.0,
        "low_demand_fn": 13709.0,
        "low_demand_tn": 206927.0,
        "low_demand_precision": 0.8717122361991891,
        "low_demand_recall": 0.7858604476795952,
        "low_demand_f1": 0.8265630519251148,
        "zero_f1": 0.8265630519251148,
        "MASE": 0.5697926761872704,
        "alpha_0.1_coverage": 90.32261541225076,
        "alpha_0.1_width": 10.941794421059761,
        "alpha_0.2_coverage": 80.34920064666787,
        "alpha_0.2_width": 5.901487283414888
      },
      "params": {
        "learning_rate": 0.026276920623647244,
        "max_depth": 5,
        "subsample": 0.8170784332632994,
        "colsample_bytree": 0.6563696899899051,
        "min_child_weight": 9,
        "reg_alpha": 4.6876566400928895e-08,
        "reg_lambda": 7.620481786158549
      },
      "train_time_sec": 1142.9758131504059
    }
  },
  "baseline_results": {
    "rf_single": {
      "MAE": 3.165455135261392,
      "MSE": 91.91259390458181,
      "RMSE": 9.58710560620784,
      "R2": 0.9349194822933625,
      "RMSLE": 0.3152700573623589,
      "MAPE": 47.0331048525724,
      "SMAPE": 42.50780722985908,
      "WMAPE": 23.70309677976924,
      "MdAE": 0.8882739812816832,
      "MPE": 14.863901157212805,
      "MBE": -0.9234063150816498,
      "OverForecastRate": 50.91683132746542,
      "WMAPE_revenue": 26.420156016353538
    },
    "xgb_single": {
      "MAE": 3.2580665523502383,
      "MSE": 105.13592397879582,
      "RMSE": 10.25358103195151,
      "R2": 0.9255564436663709,
      "RMSLE": 0.31213497312976873,
      "MAPE": 47.07859974497096,
      "SMAPE": 42.50503772986314,
      "WMAPE": 24.39657600735818,
      "MdAE": 0.8873974132537834,
      "MPE": 16.13815293365832,
      "MBE": -1.132726904166793,
      "OverForecastRate": 51.95437398958146,
      "WMAPE_revenue": 27.522673741527147
    },
    "lgbm_single": {
      "MAE": 3.2445348144604442,
      "MSE": 97.41443696061879,
      "RMSE": 9.86987522517984,
      "R2": 0.931023794235649,
      "RMSLE": 0.31311565940986014,
      "MAPE": 47.79823500937095,
      "SMAPE": 42.65367668050707,
      "WMAPE": 24.29524963276283,
      "MdAE": 0.8998047959644482,
      "MPE": 17.5583512828871,
      "MBE": -0.6740295841842276,
      "OverForecastRate": 52.79827555236214,
      "WMAPE_revenue": 26.89074620903505
    }
  },
  "best_model": "lgbm_two_stage"
}